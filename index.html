<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hece Çalışması — A E İ U O | T L N R K</title>
  <style>
    :root{
      --bg:#0f172a;          /* koyu arka plan */
      --fg:#e2e8f0;          /* yazı rengi */
      --muted:#94a3b8;       /* ikincil */
      --accent:#22c55e;      /* sayaç barı */
      --card:#111827;        /* kart */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--fg);
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue",
                   "Noto Sans", "Liberation Sans", Arial, "Apple Color Emoji",
                   "Segoe UI Emoji", "Segoe UI Symbol";
      display:flex; align-items:center; justify-content:center;
    }
    .wrap{
      width:min(900px, 95vw);
      display:grid; gap:18px; text-align:center;
    }
    .title{font-size:clamp(18px,2.6vw,22px); color:var(--muted); letter-spacing:.4px}
    .card{
      background:var(--card);
      border:1px solid rgba(255,255,255,.06);
      border-radius:20px; padding:28px 22px;
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
      cursor:pointer; user-select:none;
    }
    .syllable{
      font-weight:800; line-height:1;
      font-size:min(22vw, 180px);
      letter-spacing:.03em;
    }
    .hint{
      margin-top:10px; font-size:clamp(12px,2.2vw,14px);
      color:var(--muted)
    }
    .bar{
      height:10px; width:100%;
      background:rgba(255,255,255,.08);
      border-radius:999px; overflow:hidden;
      outline:1px solid rgba(255,255,255,.06);
    }
    .fill{
      height:100%; width:0%;
      background:var(--accent);
      transition:width .2s linear;
    }
    .row{display:flex; align-items:center; justify-content:space-between; gap:10px}
    .stat{
      font-size:clamp(12px,2.2vw,14px); color:var(--muted)
    }
    .pill{
      display:inline-block; padding:6px 10px; border-radius:999px;
      background:rgba(255,255,255,.06); color:var(--fg);
      font-weight:600; font-size:12px; letter-spacing:.3px
    }
    .kbd{
      border:1px solid rgba(255,255,255,.18);
      background:#0b1220; border-radius:6px; padding:2px 6px; font-size:12px
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="title">Hece Çalışması • Sesliler: A E İ U O • Sessizler: T L N R K</div>

    <div id="card" class="card" aria-label="Hece kartı — tıklayınca değişir">
      <div id="syllable" class="syllable">Hazır</div>
      <div class="hint">Tıkla / dokun ya da <span class="kbd">Space</span> → sonraki hece (otomatik 5 sn)</div>
    </div>

    <div class="row">
      <div class="stat">
        <span class="pill" id="modeLabel">CV • VC • CVC • VCV</span>
        &nbsp;|&nbsp; Toplam hece: <b id="totalCount">–</b>
      </div>
      <div class="stat">
        Sıradaki değişime kalan: <b id="countdown">5.0</b> sn
      </div>
    </div>

    <div class="bar" aria-hidden="true"><div id="fill" class="fill"></div></div>
  </div>

  <script>
    // === Parametreler ===
    const INTERVAL_SEC = 5; // otomatik geçiş süresi (saniye)
    const VOWELS = ['a','e','i','u','o'];           // A E İ U O (küçük; ekranda ilk harf büyük gösterilir)
    const CONSONANTS = ['t','l','n','r','k'];       // T L N R K
    const PATTERNS = ['CV','VC','CVC','VCV'];       // hangi kalıplar üretilecek

    // === Yardımcılar ===
    const trUCFirst = (s) => {
      if (!s) return s;
      return s.charAt(0).toLocaleUpperCase('tr-TR') + s.slice(1);
    };

    // Basit üretim: kalıba göre hece oluştur
    function makeByPattern(p){
      const r = (arr) => arr[Math.floor(Math.random()*arr.length)];
      switch(p){
        case 'CV':  return r(CONSONANTS) + r(VOWELS);
        case 'VC':  return r(VOWELS) + r(CONSONANTS);
        case 'CVC': return r(CONSONANTS) + r(VOWELS) + r(CONSONANTS);
        case 'VCV': return r(VOWELS) + r(CONSONANTS) + r(VOWELS);
        default:    return r(CONSONANTS) + r(VOWELS);
      }
    }

    // Tüm kombinasyonları (tekrarsız) üret, sonra karıştır
    function buildAll(){
      const set = new Set();

      // CV
      if (PATTERNS.includes('CV')){
        for (const c of CONSONANTS) for (const v of VOWELS) set.add(c+v);
      }
      // VC
      if (PATTERNS.includes('VC')){
        for (const v of VOWELS) for (const c of CONSONANTS) set.add(v+c);
      }
      // CVC
      if (PATTERNS.includes('CVC')){
        for (const c1 of CONSONANTS) for (const v of VOWELS) for (const c2 of CONSONANTS) {
          set.add(c1+v+c2);
        }
      }
      // VCV
      if (PATTERNS.includes('VCV')){
        for (const v1 of VOWELS) for (const c of CONSONANTS) for (const v2 of VOWELS) {
          set.add(v1+c+v2);
        }
      }

      const arr = [...set];
      // Küçük bir filtre: çok zor/uygunsuz kombinasyonları istersen burada ele
      // (Şimdilik hepsini bırakıyoruz)
      // Karıştır (Fisher–Yates)
      for (let i=arr.length-1; i>0; i--){
        const j = Math.floor(Math.random()*(i+1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    const ALL = buildAll();          // hazır liste
    let idx = -1;                    // mevcut index
    let elapsed = 0;                 // geçen süre (sn)
    let timerId = null;

    // === DOM ===
    const $syllable = document.getElementById('syllable');
    const $total = document.getElementById('totalCount');
    const $countdown = document.getElementById('countdown');
    const $fill = document.getElementById('fill');
    const $card = document.getElementById('card');

    $total.textContent = ALL.length.toLocaleString('tr-TR');

    function showNext(randomFallback=false){
      // Sıradaki index
      if (idx < ALL.length-1){
        idx++;
      } else {
        // sona geldiysek yeniden karıştırıp başa dön
        for (let i=ALL.length-1;i>0;i--){
          const j=Math.floor(Math.random()*(i+1));
          [ALL[i],ALL[j]]=[ALL[j],ALL[i]];
        }
        idx = 0;
      }
      const raw = ALL[idx] || makeByPattern('CV');
      $syllable.textContent = trUCFirst(raw);
      resetTimer();
    }

    function resetTimer(){
      elapsed = 0;
      renderCountdown();
    }

    function renderCountdown(){
      const remaining = Math.max(0, INTERVAL_SEC - elapsed);
      $countdown.textContent = remaining.toFixed(1);
      const pct = Math.min(100, Math.max(0, (elapsed / INTERVAL_SEC) * 100));
      $fill.style.width = pct + '%';
    }

    function tick(){
      elapsed += 0.1;
      if (elapsed >= INTERVAL_SEC){
        showNext();
      } else {
        renderCountdown();
      }
    }

    function startLoop(){
      if (timerId) clearInterval(timerId);
      timerId = setInterval(tick, 100);
    }

    // Etkileşimler
    $card.addEventListener('click', () => showNext());
    document.addEventListener('keydown', (e)=>{
      if (e.code === 'Space'){ e.preventDefault(); showNext(); }
      if (e.key === 'ArrowRight'){ showNext(); }
    });

    // İlk gösterim
    showNext(true);
    startLoop();
  </script>
</body>
</html>
